<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <base href="..">
    <link rel="shortcut icon" type="image/png" href="assets/favicon.png">
    <link rel="stylesheet" type="text/css" media="all" href="assets/main.css">
    <meta name="description" content="BNT Catalog - Barnard's star">
    <meta name="resource-type" content="document">
    <meta name="distribution" content="global">
    <meta name="KeyWords" content="BNT, Barnard's star">
    <title>BNT Catalog - Barnard's star</title>
  </head>
  <body>
    <div class="banner"> <img src="assets/banner_yanqing.jpg" alt="BNTcat Banner">
      <div class="top-left"> <span class="title1">BNT Catalog </span>
      </div>
      <div class="cite">Image taken by Zhuoxiao Wang (王卓骁) at Haituo Mountain, Yanqing</div>
    </div>
    <table class="navigation">
      <tbody>
        <tr>
          <td class="navigation"> <a title="BNT Home Page" href=".">Home</a> </td>
          <td class="navigation"> <a title="BNT Team" href="team">BNT Team</a> </td>
          <td class="navigation"> <a title="Contact Us" href="contact">Contact</a> </td>
        </tr>
      </tbody>
    </table>
    <br>
    <h2>Barnard's star</h2>
    <div class="content">
      <p>This is the BNT Catalog page for Barnard's star.</p>
      <p>Visual magnitude: 9.54</p>

      <div id="spreadsheet-data"></div>
    </div>
    <table class="sponsors">
      <tbody>
        <tr>
          <td class="sponsor"> <a href="https://www.tsinghua.edu.cn/"> <img src="assets/Tsinghua.jpg" alt="Tsinghua University"> </a> </td>
          <td class="sponsor_gap"> <br> </td>
          <td class="sponsor"> <a href="https://astro.tsinghua.edu.cn/"> <img src="assets/doa.jpg" alt="Department of Astronomy, Tsinghua University"> </a> </td>
        </tr>
      </tbody>
    </table>
    <footer> ©BNT Catalog &nbsp;|&nbsp; Based on the template by <a href="https://github.com/mikepierce">Mike Pierce</a> </footer>
    <script>
      // Function to fetch and display CSV data from Google Sheets
      async function fetchCSVData() {
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSgTM6FJOsOz1XMbikPJKe1pXpH7leVWZzsQx0UrAO1oqW5keMB6Y81XLue3uQFFil8rxvKI8XLotu5/pub?output=csv';

        const response = await fetch(csvUrl);
        const csvText = await response.text();

        const rows = csvText.split('\n').map(row => row.split(','));

        const table = document.createElement('table');
        table.border = 1;

        rows.forEach((row, rowIndex) => {
          const tr = document.createElement('tr');
          row.forEach(cell => {
            const td = document.createElement(rowIndex === 0 ? 'th' : 'td');
            td.textContent = cell;
            tr.appendChild(td);
          });
          table.appendChild(tr);
        });

        document.getElementById('spreadsheet-data').appendChild(table);
      }

      fetchCSVData();
    </script>
  
  </body>
</html>